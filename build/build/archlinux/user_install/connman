#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# User_install
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

# ...................................................................... connman

gateway=10.1.0.1

# get network hosts table
original /etc/hosts
config_install L /etc/hosts

# add host ip address
ip=$(hostname --ip-address)
hostname=$(hostname)
if grep -q " $hostname *" /etc/hosts ;then
  sudo sed -i "/ $hostname */s/^[^ ]*/$ip/" /etc/hosts
else
  sudo sed -i "/localhost.*ttrss/a$ip $hostname" /etc/hosts
fi

# set static ip
server &&
  service=$(connmanctl services | grep Wired) ||
  service=$(connmanctl services | grep Ravens)
service=$(echo $service | awk '{ print $3 }')
connmanctl config $service --ipv4 manual $ip 255.255.255.0 $gateway

# vim: set ft=sh: #
