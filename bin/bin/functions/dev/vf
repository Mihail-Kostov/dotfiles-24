#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Dev
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

# ....................................................................... Editor

usage() {
  echo "usage: $(basename $0)  <maxdepth> | <name>"
  exit 1
}

filter='\.deprecated|\.hg'

# v by directory depth or name
case "$1" in
  help) usage ;;

  '') if [ -e $DYNAMIC ] ;then
        toggle focus
        dynamic=true
      fi
      for i in $(find -L . -type d  | egrep -v "$filter")
      do
        files=$(find -L $i -maxdepth 1 -type f | egrep -v "$filter")
        [ "$files" ] || continue
        echo
        echo "$files" | sed 's|.*/||'
        if-yes "edit $i" || continue
        gvim -f $files
      done
      [ $dynamic ] && toggle focus ;;

  1 | 2 | 3 | 4) v $(find -L . -maxdepth ${1:-1} -type f | egrep -v "$filter") ;;
  *            ) v $(find -L . -type f -name "$1" | egrep -v "$filter") ;;
esac

# vim: set ft=sh: #
