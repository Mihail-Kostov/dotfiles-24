#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# Package
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

# ........................................................... Package management

# AUR package manager
if [ -z "$*" ] ;then
  mirrorlist Canada
  # pacaur -Syu --repo
  # pacaur -Su --aur --noconfirm

  # see post_install grub-btrfs-git
  [ -x /etc/grub.d/41_snapshots-btrfs ] || sudo chmod 755 /etc/grub.d/41_snapshots-btrfs
  snapper --verbose cleanup number

  # note: ignorepkg any packages that abort upgrade
  # if-no && (a) || (b) shortform cannot be used because return of (a) may be false
  if if-no 'upgrade --devel packages' ;then
    pacupg --aur
  else
    pacupg --devel 
  fi

  # update any .pacnew configs
  pacnew=$(sudo find /etc -name '*.pacnew')
  if [ "$pacnew" ] ;then
    echo "$pacnew"
    if-no 'merge .pacnew files' || dmenu pacnews
  fi
  if-no 'apply post arch install updates and cleanup' || $HOME/build/archlinux/archlinux-update
else
  pacaur $@
fi

# vim: set ft=sh: #
