#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# File
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

# ........................................................................ Print

usage() {
  echo "usage: $(basename $0)  eject | stdin | mail | prev'iew  [<filelist>]"
  exit 1
}

# page printing
format='--pretty-print --color --fancy-header --font=Courier8 --header-font=Helvetica12 --media=Letter --portrait --tabsize=4'
[ $noln ] || format="$format --line-numbers"

case $1 in
  h | '') usage ;;

  eject) # force immediate print with hp (escape) reset code
         printf '\033E' | lpr -P $PRINTER ;;

  stdin) iconv -c -f utf-8 -t ascii | enscript $format
         pr eject ;;

  mail) sed -n '/^Date: /,$p' | noln=true pr stdin ;;

  v) printfile=$(mktemp)
     # note: header font spec doesn't appear to do anything
     enscript $format --output=$printfile $2
     zathura $printfile
     rm -f $printfile ;;

  *) for file in $@
     do
       cat $file | pr stdin
     done ;;
esac

# vim: set ft=sh: #
