#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# File
# ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂

# ........................................................................ Print

usage() {
  echo "usage: $(basename $0)  eject | stdin | mail | prev'iew  [<filelist>]"
  exit 1
}

# page printing
format='--pretty-print --color --fancy-header --header-font=Helvetica12 --media=Letter --portrait --tabsize=4'
[ $text ] && format="$format --font=Times-Roman11" || format="$format --line-numbers --font=Courier9"

case $1 in
  h | '') usage ;;

  eject) # force immediate print with hp (escape) reset code
         printf '\033E' | lpr -P $PRINTER ;;

  stdin) iconv -c -f utf-8 -t ascii | enscript $format
         pr eject ;;

  mail) sed -n '/^Date: /,$p' | fontsize=12 pr stdin ;;

  v) printfile=$(mktemp)
     # note: header font spec doesn't appear to do anything
     enscript $format --output=$printfile "$2"
     zathura $printfile
     rm -f $printfile ;;

  *) while [ $# -gt 0 ]
     do
       # filenames may have blanks, hence, usage of while vs for i in $@
       enscript $format "$1"
       shift
     done
     pr eject ;;
esac

# vim: set ft=sh: #
