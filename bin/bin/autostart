#!/usr/bin/dash
# sdothum - 2016 (c) wtfpl

# X11 startup
# ▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬▬

# ....................................................... Window manager restart

killall -TERM imapfilter 2>/dev/null
killall -TERM ncmpcpp 2>/dev/null
killall -TERM offlineimap 2>/dev/null
killall -TERM unclutter 2>/dev/null
killall -TERM weechat 2>/dev/null

# ....................................................... Session initialization

rm -f $HOME/.msmtpqueue/.lock 2>/dev/null
rm -f $HOME/.nzbget.paused 2>/dev/null
rm -f /tmp/setroot 2>/dev/null
rm -f /srv/http/tt-rss/lock/* 2>/dev/null

gnome-keyring-daemon -s --components=pkcs11,secrets,ssh,gpg &
is_laptop && synclient VertEdgeScroll=1 &
is_laptop && synclient TapButton1=1 &
pidof gpg-agent >/dev/null \
|| gpg-agent --homedir /home/shum/.gnupg --use-standard-socket --daemon 2>/tmp/gpg-agent.log &
ipfilter &
xrdb -merge $HOME/.Xresources &

# ...................................................................... Daemons

# pidof dunst || dunst 2>/dev/null &
pidof mpd || sleep 2 && mpd &
pidof nzbget || nzbget --daemon &
pidof urxvtd || urxvtd -q -o -f &

# ....................................................... Desktop initialization

draw compton
dispread -v -d2 -c1 -yl "-P0.012987012987,1,4.11345646438" \
         -k "L3007WFPHC 2014-02-04 2.2 M-S 3xCurve+MTX.cal" \
         -s "L3007WFPHC 2014-02-04 2.2 M-S 3xCurve+MTX" 2>/dev/null
dispread -v -d1 -c1 -yl "-P0.0195488721805,1,4.07630522088" \
         -k "L 2209WA 2014-02-04 2.2 M-S 3xCurve+MTX.cal" \
         -s "L 2209WA 2014-02-04 2.2 M-S 3xCurve+MTX" 2>/dev/null
dmenu screensaver on

# ................................................................. Systray apps

ps -ef | grep autokey-gtk | grep -qv grep || autokey-gtk --verbose >/tmp/autokey.log 2>/dev/null &
pidof clipit >/dev/null || clipit &
pidof xfce4-power-manager >/dev/null || xfce4-power-manager 2>/dev/null &

# ................................................................ Terminal apps

[ $TRACE ] && term 'Trace' tail -f /tmp/herbstluftwm.log
term 'IRC' weechat
term 'Mail' alot

# .................................................................. Window apps

$BROWSER
gvim --role='thedarnedestthing' thedarnedestthing
thedarnedestthing

# vim: set ft=sh: #
